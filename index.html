<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Street Dodger</title>
    <style>
    	* { padding: 0; margin: 100px; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="sdCanvas" width="800" height="500"></canvas>

<script>

  // Variable delarations & Assignments
  //
  const canvas = document.getElementById("sdCanvas");
	const ctx = canvas.getContext("2d");

  let pedestrianX = 820;
  let pedestrianY = 400;

  let playerX = 100;
  let playerY = 400;

  let dodgeKeyX = 800;
  let dodgeKeyY = 50;

  let dx = -2;
  let dy = 0;

  let keyPresses = {
    qPressed: false,
    wPressed: false,
    ePressed: false,
    rPressed: false
  };

  let dodgeWindowColor = "blue";
  //

  // Key Bindings Setup
  //
  document.addEventListener("keydown", keyDownHandler, false);
  document.addEventListener("keyup", keyUpHandler, false);

  function keyDownHandler(e) {
    switch (e.keyCode) {
      case 81:
        keyPresses["qPressed"] = true;
        break;
      case 87:
        keyPresses["wPressed"] = true;
        break;
      case 69:
        keyPresses["ePressed"] = true;
        break;
      case 82:
        keyPresses["rPressed"] = true;
        break;
    }
  };

  function keyUpHandler(e) {
    switch (e.keyCode) {
      case 81:
        keyPresses["qPressed"] = false;
        break;
      case 87:
        keyPresses["wPressed"] = false;
        break;
      case 69:
        keyPresses["ePressed"] = false;
        break;
      case 82:
        keyPresses["rPressed"] = false;
        break;
    }
  };

  function colorDodgeWindow () {
    for (var key in keyPresses) {
      if (keyPresses.hasOwnProperty(key)) {
        if (keyPresses[key] === true) {
          dodgeWindowColor = "yellow";
          return;
        }
      }
    }

    dodgeWindowColor = "blue";
  }
  //

  // Element Draw Logic
  //
  const walkerWidth = 30;
  const walkerHeight = 50;

  function drawPedestrian () {
    ctx.beginPath();
    ctx.rect(pedestrianX, pedestrianY, walkerWidth, walkerHeight);
    ctx.fillStyle = "red";
    ctx.fill();
    ctx.closePath();
  }

  function drawPlayer () {
    ctx.beginPath();
    ctx.rect(playerX, playerY, walkerWidth, walkerHeight);
    ctx.fillStyle = "blue";
    ctx.fill();
    ctx.closePath();
  }

  function drawDodgeKey () {
    ctx.beginPath();
    ctx.rect(dodgeKeyX, dodgeKeyY, 50, 50);
    ctx.fillStyle = "green";
    ctx.fill();
    ctx.closePath();
  }

  function drawDodgeWindow () {
    ctx.beginPath();
    ctx.rect(150, 50, 50, 50);
    ctx.strokeStyle = dodgeWindowColor;
    ctx.stroke();
    ctx.closePath();
  }
  //

  // Master Draw Logic
  //
  function draw () {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPlayer();
    drawPedestrian();

    colorDodgeWindow();
    drawDodgeWindow();

    drawDodgeKey();

    pedestrianX += dx;
    pedestrianY += dy;
    dodgeKeyX += dx;
    dodgeKeyY += dy;
  }
  //

  // Animation
  //
  setInterval(draw, 10);
  //
</script>

</body>
</html>
